@if (condutor$ | async; as condutor) {
  <section class="mx-auto max-w-4xl px-4 py-6">
    <div>
      <h2 class="text-2xl font-semibold">Edição de Condutor</h2>
      <hr class="my-4 border-muted/30" />

      <mat-card class="p-4 rounded-2xl shadow-sm">
        <form [formGroup]="condutorForm" (ngSubmit)="editar()">
          <mat-card-header>
            <mat-card-title class="text-lg font-medium">
              Preencha o formulário de edição
            </mat-card-title>
          </mat-card-header>

          <mat-card-content class="mt-6 space-y-4">
            <!-- Cliente Dropdown -->
            <mat-form-field class="w-full">
              <mat-label>Cliente</mat-label>
              <mat-select formControlName="clienteId">
                <mat-option [value]="null">Selecione um cliente (opcional)</mat-option>
                @for (cliente of clientes$ | async; track cliente.id) {
                  <mat-option [value]="cliente.id">{{ cliente.nome }}</mat-option>
                }
              </mat-select>
            </mat-form-field>

            <!-- Cliente é condutor checkbox -->
            <div class="flex items-center">
              <mat-checkbox [(ngModel)]="clienteECondutor" [ngModelOptions]="{ standalone: true }">
                Cliente é condutor
              </mat-checkbox>
            </div>

            <!-- Nome -->
            <mat-form-field class="w-full">
              <mat-label>Nome</mat-label>
              <input matInput formControlName="nome" type="text" autocomplete="name" />

              @if (nome?.errors?.['required']) {
                <mat-error>O nome é obrigatório.</mat-error>
              }
              @if (nome?.errors?.['minlength']) {
                <mat-error>O nome deve conter no mínimo 3 caracteres.</mat-error>
              }
            </mat-form-field>

            <!-- Email -->
            <mat-form-field class="w-full mt-2">
              <mat-label>Email</mat-label>
              <input
                matInput
                formControlName="email"
                type="email"
                autocomplete="email"
                mask="A*@A*.SSS"
                [dropSpecialCharacters]="false"
              />

              @if (email?.errors?.['required']) {
                <mat-error>O email é obrigatório.</mat-error>
              }
              @if (email?.errors?.['email']) {
                <mat-error>O email deve seguir o padrão nome&#64;provedor.com.</mat-error>
              }
            </mat-form-field>

            <!-- Telefone and CPF in same row -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <mat-form-field class="w-full">
                <mat-label>Telefone</mat-label>
                <input
                  matInput
                  formControlName="telefone"
                  type="text"
                  mask="(00) 00000-0000"
                  [dropSpecialCharacters]="false"
                />

                @if (telefone?.errors?.['required']) {
                  <mat-error>O telefone é obrigatório.</mat-error>
                }
                @if (telefone?.errors?.['pattern']) {
                  <mat-error>O telefone deve seguir o padrão (00) 00000-0000.</mat-error>
                }
              </mat-form-field>

              <mat-form-field class="w-full">
                <mat-label>CPF</mat-label>
                <input
                  matInput
                  formControlName="cpf"
                  type="text"
                  mask="000.000.000-00"
                  [dropSpecialCharacters]="false"
                />

                @if (cpf?.errors?.['required']) {
                  <mat-error>O CPF é obrigatório.</mat-error>
                }
                @if (cpf?.errors?.['pattern']) {
                  <mat-error>O CPF deve seguir o padrão 000.000.000-00.</mat-error>
                }
              </mat-form-field>
            </div>

            <!-- CNH and Validade in same row -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <mat-form-field class="w-full">
                <mat-label>CNH</mat-label>
                <input matInput formControlName="cnh" type="text" />

                @if (cnh?.errors?.['required']) {
                  <mat-error>A CNH é obrigatória.</mat-error>
                }
              </mat-form-field>

              <mat-form-field appearance="fill" [floatLabel]="'always'" class="w-full">
                <mat-label>Validade</mat-label>
                <input
                  formControlName="validadeCNH"
                  matInput
                  type="datetime"
                  mask="00/00/0000"
                  [dropSpecialCharacters]="false"
                />

                @if (validadeCNH?.hasError('required')) {
                  <mat-error>A validade da CNH é obrigatória.</mat-error>
                }
              </mat-form-field>
            </div>
          </mat-card-content>

          <mat-card-actions align="end" class="flex items-center justify-end gap-3 pt-4">
            <a mat-stroked-button routerLink="/condutores" class="px-4"> Voltar </a>

            <button type="submit" [disabled]="condutorForm.invalid" mat-flat-button class="px-6">
              <mat-icon class="!text-base mr-1">check</mat-icon>
              Concluir
            </button>
          </mat-card-actions>
        </form>
      </mat-card>
    </div>
  </section>
}
